?blogdown::`blogdown-package`
blogdown::new_post
function (title, kind = "", open = interactive(), author = getOption("blogdown.author"),
categories = NULL, tags = NULL, date = Sys.Date(), file = NULL,
slug = NULL, title_case = getOption("blogdown.title_case"),
subdir = getOption("blogdown.subdir", "post"), ext = getOption("blogdown.ext",
".md"))
{
if (is.null(file))
file = post_filename(title, subdir, ext, date)
file = trim_ws(file)
if (missing(kind))
kind = default_kind(file)
if (is.null(slug) && auto_slug())
slug = post_slug(file)
slug = trim_ws(slug)
if (generator() == "hugo")
file = new_content(file, kind, FALSE)
else {
writeLines(c("---", "", "---"), file)
}
if (isTRUE(title_case))
title_case = tools::toTitleCase
if (is.function(title_case))
title = title_case(title)
if (get_option("blogdown.warn.future", TRUE)) {
if (isTRUE(tryCatch(date > Sys.Date(), error = function(e) FALSE)))
warning("The date of the post is in the future: ",
date, ". See ", "https://github.com/rstudio/blogdown/issues/377 for consequences, ",
"and see https://alison.rbind.io/post/2019-03-04-hugo-troubleshooting/#dates ",
"for a workaround by distinguishing date and publishDate in YAML header. ",
"To turn off this warning, set options(blogdown.warn.future = FALSE).")
}
do.call(modify_yaml, c(list(file, title = title, author = author,
date = format(date), slug = slug, categories = as.list(categories),
tags = as.list(tags)), if (!file.exists("archetypes/default.md")) list(draft = NULL)))
open_file(file, open)
file
}
x <- function (title, kind = "", open = interactive(), author = getOption("blogdown.author"),
categories = NULL, tags = NULL, date = Sys.Date(), file = NULL,
slug = NULL, title_case = getOption("blogdown.title_case"),
subdir = getOption("blogdown.subdir", "post"), ext = getOption("blogdown.ext",
".md"))
{
if (is.null(file))
file = post_filename(title, subdir, ext, date)
file = trim_ws(file)
if (missing(kind))
kind = default_kind(file)
if (is.null(slug) && auto_slug())
slug = post_slug(file)
slug = trim_ws(slug)
if (generator() == "hugo")
file = new_content(file, kind, FALSE)
else {
writeLines(c("---", "", "---"), file)
}
if (isTRUE(title_case))
title_case = tools::toTitleCase
if (is.function(title_case))
title = title_case(title)
if (get_option("blogdown.warn.future", TRUE)) {
if (isTRUE(tryCatch(date > Sys.Date(), error = function(e) FALSE)))
warning("The date of the post is in the future: ",
date, ". See ", "https://github.com/rstudio/blogdown/issues/377 for consequences, ",
"and see https://alison.rbind.io/post/2019-03-04-hugo-troubleshooting/#dates ",
"for a workaround by distinguishing date and publishDate in YAML header. ",
"To turn off this warning, set options(blogdown.warn.future = FALSE).")
}
do.call(modify_yaml, c(list(file, title = title, author = author,
date = format(date), slug = slug, categories = as.list(categories),
tags = as.list(tags)), if (!file.exists("archetypes/default.md")) list(draft = NULL)))
open_file(file, open)
file
}
args(x)
setwd("./blogdown-default/")
setwd("~/Dropbox/coding/rproj/blogdown-default")
df %>%
mutate(month = month(date), year = year(date)) %>%
group_by(month, year) %>%
summarise(total = sum(value))
df <- data.frame(date = seq.Date(from =as.Date("01/01/1998", "%d/%m/%Y"),
to=as.Date("01/01/2000", "%d/%m/%Y"), by="day"),
value = sample(seq(5), 731, replace = TRUE))
library(dplyr)
library(lubridate)
df %>%
mutate(month = month(date), year = year(date)) %>%
group_by(month, year) %>%
summarise(total = sum(value))
df %>%
mutate(month = month(date), year = year(date)) %>%
group_by(month, year) %>%
summarise(total = sum(value)) %>%
arrange(year, month)
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df %>%
group_by(action) %>%
summarize(number = count(n))
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
summarise(total = sum(n)) %>%
arrange(year, month)
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year, action) %>%
summarise(total = sum(n)) %>%
arrange(year, month)
df.1 %<>%
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
p %<>% ggplot(df.1, aes(x = date_ann, y = total))
library(magrittr)
p %<>% ggplot(df.1, aes(x = date_ann, y = total))
p <- ggplot(df.1, aes(x = date_ann, y = total))
library(ggplot2)
p <- ggplot(df.1, aes(x = date_ann, y = total))
p <- p + geom_point()
p
View(df.1)
library(tidyverse)
library(lubridate)
date <- sample(seq(as_date('2013-06-01'), as_date('2014-5-31'), by = "day"),
10000, replace = TRUE)
value <- rnorm(10000)
df <- tibble(date, value) %>%
group_by(month = floor_date(date, unit = "month")) %>%
summarize(avg = mean(value))
View(df)
ggplot(df, aes(x = month, y = avg)) +
geom_bar(stat = "identity") +
scale_x_date(NULL, date_labels = "%b %y", breaks = "month")
## Load frequently used packages for blog posts
packages <- c(
'devtools', #for session info
'ggthemes', #for plots
'blogdown'
)
lapply(packages, function(x) {
if (!requireNamespace(x)) install.packages(x)
library(x, character.only = TRUE)
})
## Do not break chunk line
## Do not use spaces or periods "." or underscores "_"
## set options for knitr
knitr::opts_chunk$set(
comment = '',
fig.width = 6,
fig.asp = .8,
fig.align="center",
message=F,
error=F,
warning=F,
tidy=T,
comment='',
cache=T,
dev='svg',
echo=F
)
#from ggthemes
library(ggplot2); theme_set(ggthemes::theme_fivethirtyeight())
# color blind friendly palette from http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#000000")
# write packages used to bib in current directory
knitr::write_bib(.packages(), "./packages.bib")
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df <- tibble(date, value) %>%
group_by(month = floor_date(date, unit = "month")) %>%
summarize(avg = mean(value))
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
View(df.1)
p <- ggplot(df.1, aes(x = month, y = total, group = action, color = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "month")
p
p <- ggplot(df.1, aes(x = month, y = total, group = action, color = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p
?RcolorBrewer::
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Dark2")
p
p <- p +scale_fill_brewer(palette="Accent")
p
p <- p +scale_fill_brewer(palette="Set1")
p
p <- p +scale_fill_brewer(palette="Pastel1")
p
p <- p +scale_fill_brewer(palette="Pastel2")
p
p <- p +scale_fill_brewer(palette="Accent")
p
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021")
p
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
unique(df$action)
df$action <- gsub("Information", "Info\\.", df$action))
df$action <- gsub("Information", "Info\\.", df$action)
unique(df$action)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021")
p
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- gsub("Information", "Info\\.", df$action)
df$action <- gsub("Presidential", "Pres\\.", df$action)
unique(df$action)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021")
p
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- gsub("Information", "Info\\.", df$action)
df$action <- gsub("Collection", "Coll\\.", df$action)
df$action <- gsub("Presidential", "Pres\\.", df$action)
unique(df$action)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021")
p
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021",
caption = "Hello")
p
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021",
caption = "<b>Source:</b> Immigration Policy Tracking Project")
p
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021",
caption = "Source: Immigration Policy Tracking Project")
p
citr:::insert_citation()
blogdown::serve_site()
## Load frequently used packages for blog posts
packages <- c(
'devtools', #for session info
'ggthemes', #for plots
'blogdown'
)
lapply(packages, function(x) {
if (!requireNamespace(x)) install.packages(x)
library(x, character.only = TRUE)
})
## Do not break chunk line
## Do not use spaces or periods "." or underscores "_"
## set options for knitr
knitr::opts_chunk$set(
comment = '',
fig.width = 6,
fig.asp = .8,
fig.align="center",
message=F,
error=F,
warning=F,
tidy=T,
comment='',
cache=T,
dev='svg',
echo=F
)
#from ggthemes
library(ggplot2); theme_set(ggthemes::theme_fivethirtyeight())
# color blind friendly palette from http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/
cbPalette <- c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7", "#000000")
# write packages used to bib in current directory
knitr::write_bib(.packages(), "./packages.bib")
file <- "~/Dropbox/public/datasets/2021-04-01-us-immigration-policies-guttentag.csv"
df <- readr::read_csv(file = file)
#date
df$date_ann_1 <- gsub(",", "", df$date_ann)
df$date_ann <- as.Date(df$date_ann_1, format = "%B %d %Y")
df <- select(df, url:agencies)
df <- tidyr::separate_rows(df, status, sep = "\\|")
df <- dplyr::filter(df, status == "Final/Actual")
df$action <- sapply(stringr::str_split(df$action, "\\|"), '[[', 1)
df$action <- gsub("Information", "Info\\.", df$action)
df$action <- gsub("Collection", "Coll\\.", df$action)
df$action <- gsub("Presidential", "Pres\\.", df$action)
unique(df$action)
df$action <- forcats::fct_lump(df$action, n = 6)
df$n <- 1
library(lubridate)
library(dplyr)
df.1 <-
df %>%
mutate(month = month(date_ann), year = year(date_ann)) %>%
group_by(month, year) %>%
mutate(total = sum(n)) %>%
arrange(year, month)
df.1 <- df %>%
select(date_ann, action, n) %>%
group_by(month = floor_date(date_ann, unit = "month"), action) %>%
summarize(total = sum(n))
library(magrittr)
library(ggplot2)
p <- ggplot(df.1, aes(x = month, y = total, group = action, fill = action))
p <- p + geom_bar(stat = "identity")
p <- p + scale_x_date(NULL, date_labels = "%b %y", breaks = "year")
p <- p +scale_fill_brewer(palette="Accent")
p <- p + ggtitle("U.S. Immigration Policy by Action")
p <- p + labs(subtitle = "Jan. 2017 -- Jan. 2021",
caption = "Source: Immigration Policy Tracking Project")
p
# system & package info
options(width = 120)
session_info()
stop_server()
blogdown::serve_site()
