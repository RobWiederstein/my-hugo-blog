saveRDS(., file = "./content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_sports_tbl.rds")
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
group_by(year, sport, gender, variable) %>%
summarize(avg = mean(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = avg) ->a #%>%
?dplyr::summarise
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
group_by(year, sport, gender, variable) ->a # %>%
# load datasets ----
high_school_part <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/hs_part_rate.rds")
us_states <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/us_poly.rds")
high_school_part %>%
filter(year == 2013) %>%
filter(gender == "male") %>%
filter(variable == "part") %>%
group_by(year, sport) %>%
summarize(us_part = sum(value, na.rm = T)) %>%
arrange(desc(us_part)) %>%
slice_head(n = 10) %>%
pull(sport) -> top_10_male_sports_2013
top_10_male_sports_2013
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
group_by(year, sport, gender, variable) %>%
summarize(avg = mean(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = avg) %>%
select(sport, gender, enrolled_2013, enrolled_2018, part_2013, part_2018,
part_rate_2013, part_rate_2018, `5yr_pct_chg_part_rate_2018`) %>%
filter(gender == "male") %>%
arrange(desc(`5yr_pct_chg_part_rate_2018`)) %>%
saveRDS(., file = "./content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_sports_tbl.rds")
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
group_by(year, sport, gender, variable) %>%
summarize(avg = mean(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = avg) %>%
select(sport, gender, enrolled_2013, enrolled_2018, part_2013, part_2018,
part_rate_2013, part_rate_2018, `5yr_pct_chg_part_rate_2018`) %>%
filter(gender == "male") %>%
arrange(desc(`5yr_pct_chg_part_rate_2018`)) -> a#%>%
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
group_by(year, sport, gender, variable) %>%
summarize(avg = mean(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = avg) %>%
select(sport, gender, enrolled_2013, enrolled_2018, part_2013, part_2018,
part_rate_2013, part_rate_2018, `5yr_pct_chg_part_rate_2018`) %>%
filter(gender == "male") %>%
arrange(desc(`5yr_pct_chg_part_rate_2018`)) %>%
saveRDS(., file = "./content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_sports_tbl.rds")
top_10_sports_tbl <- readRDS("~/Dropbox/coding/rproj/my-hugo-blog/content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_sports_tbl.rds")
View(top_10_sports_tbl)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(1:4, digits = 0) %>%
DT::formatRound(5:9, digits = 3)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3)
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', fontWeight = styleInterval(5, c('normal', 'bold')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', fontWeight = styleInterval(5, c('normal', 'bold')))
?formatStyle
?styleInterval
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(3.4, 3.8), c('white', 'blue', 'red')))
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) #%>%
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(-12, 0), c('red')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(-12, 0), c('red', 'black')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(-12, 0), c('red', 'black', 'white')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(-12, 0), c('red', 'black', 'blue')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
8185/147685
8185/147685
9002/151995
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) -> a# %>%
# load datasets ----
high_school_part <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/hs_part_rate.rds")
high_school_part %>%
filter(year == 2013) %>%
filter(gender == "male") %>%
filter(variable == "part") %>%
group_by(year, sport) %>%
summarize(us_part = sum(value, na.rm = T)) %>%
arrange(desc(us_part)) %>%
slice_head(n = 10) %>%
pull(sport) -> top_10_male_sports_2013
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) -> a# %>%
high_school_part$variable %>% table()
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) -> a# %>%
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") -> a# %>%
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
#summarize(avg = mean(value, na.rm = T), .groups = "drop") %>%
summarize(tot_sum = sum(value, na.rm = T))
pivot_wider(names_from = c(variable, year), values_from = tot_sum) -> a #%>%
library(tidyr)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T))
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T)) %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) -> a #%>%
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T)) %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) -> a
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T)) %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) -> a
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) -> a
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg` = `5yr_pct_chg` * 100) -> a
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg` = `5yr_pct_chg` * 100) %>%
mutate(gender = "male") %>%
mutate(region = "us") -> a
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg` = `5yr_pct_chg` * 100) %>%
mutate(gender = "male") %>%
mutate(region = "us") %>%
arrange(desc(`5yr_pct_chg`)) -> a
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg` = `5yr_pct_chg` * 100) %>%
mutate(gender = "male") %>%
mutate(region = "us") %>%
arrange(desc(`5yr_pct_chg`)) %>%
select(region, sport, gender, `5yr_pct_chg`) -> a
View(a)
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg_2013_to_2018` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg_2013_to_2018` = `5yr_pct_chg_2013_to_2018` * 100) %>%
mutate(gender = "male") %>%
mutate(region = "us") %>%
arrange(desc(`5yr_pct_chg_2013_to_2018`)) %>%
select(region, sport, gender, `5yr_pct_chg_2013_to_2018`) -> a
high_school_part %>%
filter(sport %in% top_10_male_sports_2013) %>%
filter(is.finite(value)) %>%
filter(variable %in% c("enrolled", "part")) %>%
filter(gender == "male") %>%
group_by(year, sport, variable) %>%
summarize(tot_sum = sum(value, na.rm = T), .groups = "drop") %>%
pivot_wider(names_from = c(variable, year), values_from = tot_sum) %>%
mutate(part_rate_2018 = part_2018 / enrolled_2018,
part_rate_2013 = part_2013 / enrolled_2013) %>%
mutate(`5yr_pct_chg_2013_to_2018` = (part_rate_2018 - part_rate_2013) / part_rate_2013) %>%
mutate(`5yr_pct_chg_2013_to_2018` = `5yr_pct_chg_2013_to_2018` * 100) %>%
mutate(gender = "male") %>%
mutate(region = "us") %>%
arrange(desc(`5yr_pct_chg_2013_to_2018`)) %>%
select(region, sport, gender, `5yr_pct_chg_2013_to_2018`) %>%
saveRDS(., file = "./content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_male_sports_tbl.rds")
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) #%>%
DT::formatRound(3:6, digits = 0) %>%
DT::formatRound(7:9, digits = 3) %>%
DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) #%>%
# DT::formatRound(3:6, digits = 0) %>%
# DT::formatRound(7:9, digits = 3) %>%
# DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) #%>%
# DT::formatRound(3:6, digits = 0) %>%
# DT::formatRound(7:9, digits = 3) %>%
# DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
top_10_male_sports_tbl <- readRDS("~/Dropbox/coding/rproj/my-hugo-blog/content/post/2024-09-22-u-s-high-school-football-participation-rates/top_10_male_sports_tbl.rds")
View(top_10_male_sports_tbl)
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) #%>%
# DT::formatRound(3:6, digits = 0) %>%
# DT::formatRound(7:9, digits = 3) %>%
# DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(4, digits = 1)
# DT::formatRound(7:9, digits = 3) %>%
# DT::formatStyle('5yr_pct_chg_part_rate_2018', color = styleInterval(c(0), c('red', 'black')))
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013) %>%
DT::formatRound(4, digits = 1) %>%
DT::formatStyle('5yr_pct_chg_2013_to_2018', color = styleInterval(c(0), c('red', 'black')))
blogdown::serve_site(
)
library(kableExtra)
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
kbl() %>%
kable_styling()
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover"))
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
?library(kableExtra
)
library(kableExtra
)
?column_spec
?format
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
mutate(`5yr_pct_chg_2013_to_2018` = format(`5yr_pct_chg_2013_to_2018`, digits = 4)) %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
mutate(`5yr_pct_chg_2013_to_2018` = format(`5yr_pct_chg_2013_to_2018`, digits = 3)) %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
top_10_male_sports_2013 %>%
mutate(`5yr_pct_chg_2013_to_2018` = format(`5yr_pct_chg_2013_to_2018`, digits = 1)) %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
mutate(`5yr_pct_chg_2013_to_2018` = format(`5yr_pct_chg_2013_to_2018`, digits = 2)) %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
library(kableExtra)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
top_10_male_sports_2013 %>%
mutate(`5yr_pct_chg_2013_to_2018` = format(`5yr_pct_chg_2013_to_2018`, digits = 2)) %>%
kbl() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
cell_spec(top_10_male_sports_2013$`5yr_pct_chg_2013_to_2018`, align = "r")
library(DT)
top_10_male_sports_2013 <- readRDS("./top_10_male_sports_tbl.rds")
DT::datatable(top_10_male_sports_2013, options = list(dom = 't')) %>%
DT::formatRound(4, digits = 1) %>%
DT::formatStyle('5yr_pct_chg_2013_to_2018', color = styleInterval(c(0), c('red', 'black')))
?DT::formatPercentage
blogdown::serve_site()
## Load frequently used packages for blog posts
packages <- c(
'devtools', #for session info
'ggthemes', #for plots
'blogdown',
'DT',
'dplyr',
'ggplot2',
'tidyr',
'colorspace',
'tidycensus'
)
lapply(packages, function(x) {
if (!requireNamespace(x)) install.packages(x)
library(x, character.only = TRUE)
})
blogdown::stop_server(
)
blogdown::serve_site()
# load datasets ----
enrollment <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/enrollments.rds")
participant <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/participants.rds")
# combine ----
inner_join(participant, enrollment, by = join_by(year, state, gender)) ->a#%>%
# libraries ----
library(magrittr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(classInt)
library(tibble)
library(sf)
# load datasets ----
enrollment <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/enrollments.rds")
participant <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/participants.rds")
# combine ----
inner_join(participant, enrollment, by = join_by(year, state, gender)) ->a#%>%
inner_join(participant, enrollment, by = join_by(year, state)) ->a#%>%
# load datasets ----
enrollment <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/enrollments.rds") %>%
filter(gender == "total")
# load datasets ----
enrollment <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/enrollments.rds") %>%
filter(gender == "total")
participant <- readRDS("./content/post/2024-09-22-u-s-high-school-football-participation-rates/participants.rds")
# combine ----
inner_join(participant, enrollment, by = join_by(year, state)) ->a#%>%
View(a)
# combine ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, state, sport) %>%
summarize(players_per_100_students = (players / enrollment) * 100) -> a#%>%
# combine ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, state, sport) %>%
summarize(players_per_100_students = (players / enrollment) * 100) -> per_player#%>%
# rank ----
per_player %>%
filter(year == max(year)) %>%
arrange(desc(players_per_100_students)) %>%
mutate(rank = row_number()) %>%
select(state, rank) -> rank_2022
# combine ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, state, sport) %>%
summarize(players_per_100_students = (players / enrollment) * 100) %>%
ungroup() -> per_player#%>%
# rank ----
per_player %>%
filter(year == max(year)) %>%
arrange(desc(players_per_100_students)) %>%
mutate(rank = row_number()) %>%
select(state, rank) -> rank_2022
# merge back ----
left_join(per_player, rank_2022, by = "state") -> per_player
forcats::fct_reorder(per_player$state, per_player$rank) -> per_player$state
# national per_player stats ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, sport) %>%
summarize(total_players = sum(players),
total_enrollment = sum(enrollment)) -> a#%>%
View(a)
# national per_player stats ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, sport) %>%
summarize(total_players = sum(players),
total_enrollment = sum(enrollment)) %>%
mutate(players_per_100_students = (total_enrollment / total_players) * 100) -> a#%>%
# national per_player stats ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, sport) %>%
summarize(total_players = sum(players),
total_enrollment = sum(enrollment)) %>%
mutate(players_per_100_students = (total_players / total_enrollment) * 100) -> a#%>%
# national per_player stats ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, sport) %>%
summarize(total_players = sum(players),
total_enrollment = sum(enrollment)) %>%
mutate(players_per_100_students = (total_players / total_enrollment) * 100) %>%
ungroup() -> a#%>%
View(a)
# national per_player stats ----
inner_join(participant, enrollment, by = join_by(year, state)) %>%
group_by(year, sport) %>%
summarize(total_players = sum(players),
total_enrollment = sum(enrollment)) %>%
mutate(players_per_100_students = (total_players / total_enrollment) * 100) %>%
ungroup() -> us_per_player
