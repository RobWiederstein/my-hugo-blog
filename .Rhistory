#setView(-120.52462403790528, 37.74238197955183, zoom = 5) |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
addTiles() |>
addPolygons(data = ca_counties,
popup = ~name)
counties_join_by_group <-
ca |>
dplyr::mutate(number = 1) |>
dplyr::group_by(statefp) |>
dplyr::summarize(tot = sum(number))
#map
leaflet() |>
#fitBounds(-124.4, 32.5, -114.1,  42) |>
setView(-120.52462403790528, 37.74238197955183, zoom = 5) |>
addTiles() |>
addPolygons(data = counties_join_by_group)
# join counties into California
counties_join_by_union <- sf::st_union(ca)
# map
leaflet() %>%
fitBounds(-124.4, 32.5, -114.1,  42) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(
data = counties_join_by_union
)
centroids <- sf::st_centroid(ca)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
#layer groups
addPolygons(data = sf::st_union(ca),
group = "State") |>
addPolygons(data = ca,
group = "Counties") |>
addMarkers(lat = unlist(lapply(centroids$geometry, "[[", 2)),
lng = unlist(lapply(centroids$geometry, "[[", 1)),
group = "Centroids"
) |>
#layer control
addLayersControl(
overlayGroups = c("State", "Counties", "Centroids"),
position = "topright",
options = layersControlOptions(collapsed = FALSE)
) |>
# hide
hideGroup(c("State", "Counties", "Centroids"))
file <- 'https://www.ers.usda.gov/webdocs/DataFiles/48747/Unemployment.xlsx'
usda <- rio::import(
file = file,
skip = 4
) |>
dplyr::rename_all(~janitor::make_clean_names(.x)) |>
dplyr::select(fips_code:area_name, unemployment_rate_2020) |>
dplyr::filter(state == "CA") |>
tidyr::separate(fips_code, into = c("statefp", "countyfp"), sep = 2) |>
dplyr::select(statefp, countyfp, unemployment_rate_2020)
library(blogdown)
## Load frequently used packages for blog posts
packages <- c(
'devtools', #for session info
'blogdown',
'sf',
'leaflet'
)
lapply(packages, function(x) {
if (!requireNamespace(x)) install.packages(x)
library(x, character.only = TRUE)
})
## Do not break chunk line
## Do not use spaces or periods "." or underscores "_"
## set options for knitr
knitr::opts_chunk$set(
comment = '',
fig.width = 6,
fig.asp = .8,
fig.align="center",
message=F,
error=F,
warning=F,
tidy=F,
comment='',
cache=F,
dev='svg',
echo=F
)
# write packages used to bib in current directory
knitr::write_bib(.packages(), "./packages.bib")
#download file to local drive
url <- "https://www2.census.gov/geo/tiger/GENZ2020/shp/cb_2020_us_county_20m.zip"
destfile <- "cb_2020_us_county_20m.zip"
if(!file.exists(destfile)){download.file(url = url, destfile = destfile)}
#read in file
library(sf)
#all counties
counties <-
sf::st_read(
dsn = "cb_2020_us_county_20m",
layer = "cb_2020_us_county_20m"
) |>
# convert coordinates to simple feature
sf::st_transform('+proj=longlat +datum=WGS84') |>
# reduce file size
sf::st_simplify() |>
# convert variables to lowercase
dplyr::rename_all(~janitor::make_clean_names(.x))
#california fips is "06"
ca <-
counties |>
dplyr::filter(grepl("06", statefp))
plot(ca |> dplyr::select(countyfp))
ca_counties <-
ca |>
dplyr::filter(name %in% c("Los Angeles", "San Francisco", "Napa"))
library(leaflet)
leaflet() |>
#setView(-120.52462403790528, 37.74238197955183, zoom = 5) |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
addTiles() |>
addPolygons(data = ca_counties,
popup = ~name)
counties_join_by_group <-
ca |>
dplyr::mutate(number = 1) |>
dplyr::group_by(statefp) |>
dplyr::summarize(tot = sum(number))
#map
leaflet() |>
#fitBounds(-124.4, 32.5, -114.1,  42) |>
setView(-120.52462403790528, 37.74238197955183, zoom = 5) |>
addTiles() |>
addPolygons(data = counties_join_by_group)
# join counties into California
counties_join_by_union <- sf::st_union(ca)
# map
leaflet() %>%
fitBounds(-124.4, 32.5, -114.1,  42) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(
data = counties_join_by_union
)
centroids <- sf::st_centroid(ca)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
#layer groups
addPolygons(data = sf::st_union(ca),
group = "State") |>
addPolygons(data = ca,
group = "Counties") |>
addMarkers(lat = unlist(lapply(centroids$geometry, "[[", 2)),
lng = unlist(lapply(centroids$geometry, "[[", 1)),
group = "Centroids"
) |>
#layer control
addLayersControl(
overlayGroups = c("State", "Counties", "Centroids"),
position = "topright",
options = layersControlOptions(collapsed = FALSE)
) |>
# hide
hideGroup(c("State", "Counties", "Centroids"))
file <- 'https://www.ers.usda.gov/webdocs/DataFiles/48747/Unemployment.xlsx'
usda <- rio::import(
file = file,
skip = 4
) |>
dplyr::rename_all(~janitor::make_clean_names(.x)) |>
dplyr::select(fips_code:area_name, unemployment_rate_2020) |>
dplyr::filter(state == "CA") |>
tidyr::separate(fips_code, into = c("statefp", "countyfp"), sep = 2) |>
dplyr::select(statefp, countyfp, unemployment_rate_2020)
ca_choropleth <-
dplyr::left_join(ca, usda, by = c("statefp", "countyfp"))
# system & package info
options(width = 120)
session_info()
pal <- colorNumeric(palette = RColorBrewer::brewer.pal(5, "Dark2"),
domain = ca_choropleth$unemployment_rate_2020
)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(data = ca_choropleth,
color = ~pal(unemployment_rate_2020),
popup = ~unemployment_rate_2020)
pal <- colorNumeric(palette = RColorBrewer::brewer.pal(5, "Dark2"),
domain = ca_choropleth$unemployment_rate_2020
)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(data = ca_choropleth,
color = ~pal(unemployment_rate_2020),
popup = ~unemployment_rate_2020)
pal <- colorNumeric(palette = RColorBrewer::brewer.pal(5, "Dark2"),
domain = ca_choropleth$unemployment_rate_2020
)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(data = ca_choropleth,
color = ~pal(unemployment_rate_2020),
popup = ~unemployment_rate_2020)
blogdown::check_site()
blogdown::check_site()
blogdown::build_site(build_rmd = 'newfile')
blogdown::check_site()
blogdown::build_site(build_rmd = 'timestamp')
blogdown::build_site(build_rmd = 'newfile')
blogdown::serve_site()
blogdown::check_site()
blogdown:::new_post_addin()
stop_server()
check_site()
blogdown::serve_site()
stop_server()
check_site()
blogdown::build_site(build_rmd = 'timestamp')
install.packages("babynames")
blogdown::build_site(build_rmd = 'timestamp')
check_site()
blogdown::build_site(build_rmd = 'newfile')
check_site()
blogdown::serve_site()
# write packages used to bib in current directory
knitr::write_bib(.packages(), "./packages.bib")
## Load frequently used packages for blog posts
packages <- c(
'devtools', #for session info
'blogdown',
'sf',
'leaflet'
)
lapply(packages, function(x) {
if (!requireNamespace(x)) install.packages(x)
library(x, character.only = TRUE)
})
centroids
?coffee_data
?sf::coffee_data
?world::coffee_data
?spData::coffee_data
spData::coffee_data |> head()
spData::coffee_data |> class()
ca_choropleth
pal <- colorNumeric(palette = RColorBrewer::brewer.pal(5, "Dark2"),
domain = ca_choropleth$unemployment_rate_2020
)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(data = ca_choropleth,
color = ~pal(unemployment_rate_2020),
label = ~unemployment_rate_2020)
?RColorBrewer
RColorBrewer::brewer.pal(5, BrBG)
RColorBrewer::brewer.pal(5, 'BrBG')
pal <- colorNumeric(palette = RColorBrewer::brewer.pal(5, "BrBG"),
domain = ca_choropleth$unemployment_rate_2020
)
leaflet() |>
fitBounds(-122.6, 32.8, -117.6, 38.8) |>
#base groups
addTiles(group = "OSM (default)") |>
addPolygons(data = ca_choropleth,
color = ~pal(unemployment_rate_2020),
label = ~unemployment_rate_2020)
R-sf
citation("R")
?citation
citation("lattice")
citation("rio")
citation("RColorBrewer")
citr:::insert_citation()
citr:::insert_citation()
citation(R-rio)
citation("rio")
citation("RColorBrewer")
citation("janitor")
stop_server()
serve_site()
citr:::insert_citation()
citr:::insert_citation()
blogdown:serve_site()
blogdown::serve_site()
styler:::style_selection()
devtools::install_github("gadenbuie/grkstyle")
grkstyle::use_grk_style()
do_something_very_complicated(something = "that", requires = many,
arguments = "some of which may be long")
styler:::style_selection()
styler:::style_selection()
citr:::insert_citation()
citr:::insert_citation()
citr:::insert_citation()
library(lobstr)
?lobstr::mem_used
mem_used()
citr:::insert_citation()
?styler
style_text("call( 1)")
library(styler)
style_text("call( 1)")
style_text("1    + 1", strict = FALSE)
style_text("a%>%b", scope = "spaces")
style_text("a%>%b; a", scope = "line_breaks")
style_text("a%>%b; a", scope = "tokens")
grkstyle::use_grk_style()
dput(letters[1:5])
style_text(paste0("a", "b", "c", "d", "e"))
style_text("paste0("a", "b", "c", "d", "e")")
style_text('paste0("a", "b", "c", "d", "e")')
paste0("a", "b", "c", "d", "e")
styler:::style_selection()
styler:::style_selection()
grkstyle::use_grk_style()
?grkstyle
styler:::style_selection()
#example
readr::read_csv('./my_table.csv',col_names=c('a','b'))
styler:::style_selection()
citr:::insert_citation()
library(styler)
string_to_format <-
"mtcars %>%
dplyr::group_by(am, cyl) %>%
dplyr::summarise(
drat_mean = mean(drat),
disp_mean = mean(disp)
)"
all.equal(
style_text(string_to_format, transformers = tidyverse_style(indent_by = 6)),
style_text(string_to_format, style = tidyverse_style, indent_by = 6),
style_text(string_to_format, indent_by = 6),
)
?library
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
vignette("styler")
?vignette
?vignettes
vignette(package = "styler")
source("~/Dropbox/coding/rproj/my-hugo-blog/content/post/2022-03-09-styling-r-code-for-better-development/script_1.R")
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
?grkstyle::grk_style_transformer
style_text("a=b")
styler::style_text("a=b")
styler::style_text("a <- function(x){x = apple, y = bananana}")
styler::style_text("a=function(x){x = apple, y = bananana}")
styler::style_text("a=function(x, y){x = as.integer(x), y = as.integer(y)}")
styler::style_text("a=function(x, y){x = as.integer(x) y = as.integer(y)}")
styler::style_text("long_function_name <- function(
a = "a long argument",
b = "another argument",
c = "another long argument"
) {
# As usual code is indented by two spaces.
}")
styler::style_text("a=b")
styler::style_text("a=b", transformers = tidyverse_style(indent_by=4))
library(styler)
styler::style_text("a=b", transformers = tidyverse_style(indent_by=4))
styler::style_text("a=b", transformers = grkstyle::grk_style_transformer())
styler::style_text("a=b", transformers = grkstyle::grk_style_transformer(indent_by = 4))
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
blogdown::serve_site()
styler:::style_active_file()
styler:::style_active_file()
url_news_search <-
paste0(
"https://www.google.com/search?q=",
"site:nytimes.com+OR+",
"site:washingtonpost.com+OR+",
"site:bloomberg.com+",
"%s"
)
print(url_news_search)
styler:::style_active_file()
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"%s"
)
print(url_r_search)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:community.rstudio.com/+"
"%s"
)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:community.rstudio.com+"
"%s"
)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:community.rstudio.com+",
"%s"
)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:community.rstudio.com+",
"%s"
)
print(url_r_search)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:bigbookofr.com+OR+",
"site:community.rstudio.com+",
"%s"
)
print(url_r_search)
url_r_search <-
paste0(
"https://www.google.com/search?q=",
"site:https://cran.r-project.org+OR+",
"site:stackoverflow.com+OR+",
"site:r-bloggers.com+OR+",
"site:bigbookofr.com+OR+",
"site:community.rstudio.com+",
"%s"
)
print(url_r_search)
blogdown:::new_post_addin()
blogdown::serve_site()
blogdown::serve_site()
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io+OR+",
"site:discourse.gohugo.io/+OR+",
"github.com/gohugoio/hugo/issues+OR+",
"stackoverflow.com/questions/tagged/hugo"
)
print(url_news_search)
print(url_hugo_search)
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io+OR+",
"site:discourse.gohugo.io/+OR+",
"github.com/gohugoio/hugo/issues"
)
print(url_hugo_search)
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io+OR+",
"site:discourse.gohugo.io/+OR+",
"stackoverflow.com/questions/tagged/hugo"
)
print(url_hugo_search)
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io+OR+",
"site:discourse.gohugo.io/+OR+",
"stackoverflow.com/"
)
print(url_hugo_search)
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io+OR+",
"site:discourse.gohugo.io"
)
print(url_hugo_search)
url_hugo_search <-
paste0(
"https://www.google.com/search?q=",
"site:gohugo.io/documentation+OR+",
"site:discourse.gohugo.io"
)
print(url_hugo_search)
blogdown::serve_site()
blogdown::serve_site()
styler:::style_active_file()
